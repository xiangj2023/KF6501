
#ifndef _MISI_H_
#define _MISI_H_

#include "serial.h"

//串口任务定时器时间间隔，单位毫秒
#define SERIAL_TASK_TIMER	20

#define RESET_RXDBUF	0x0001
#define RESET_TXDBUF	0x0002
#define RESET_SERIAL	0x0004

/*************************************************************************************
* 串口守护任务入口函数                                                          
*************************************************************************************/
void MisiDaemon(DWORD *arg);

/*************************************************************************************
* 串口任务定时处理过程                                                          
*************************************************************************************/
void MisiOnTimer();

/*************************************************************************************
* 串口初始化                                                          
*************************************************************************************/
void MisiInit();

/*************************************************************************************
* 串口打开，供端口层使用                                                          
*************************************************************************************/
DWORD  MisiOpen(DWORD dwPort, DWORD dwRxdLen, DWORD dwTxdLen, DWORD dwMode);

/*************************************************************************************
* 串口设置，供端口层使用                                                          
*************************************************************************************/
DWORD  MisiCtrl(DWORD dwPort , TCtlComm *pCtrl);

/*************************************************************************************
* 向串口写入数据，供端口层使用                                                          
*************************************************************************************/
DWORD MisiWrite(DWORD dwPort, BYTE* pBuf, WORD wLen, DWORD dwFlag);

/*************************************************************************************
* 从串口读取一定长度数据，供端口层使用                                                          
*************************************************************************************/
DWORD MisiRead(DWORD dwPort, BYTE* pBuf, WORD wLen, DWORD dwFlag);

/*************************************************************************************
* 串口复位，供端口层使用                                                          
*************************************************************************************/
DWORD MisiReset(DWORD dwPort, DWORD dwFlag);

/*************************************************************************************
* 根据端口号获取串口序号                                                          
*************************************************************************************/
int GetPortSort(DWORD dwPort);

/*************************************************************************************
* 根据串口序号获取对应串口通道的类指针                                                          
*************************************************************************************/
CSerial * GetSortSerial(WORD wNum);

/*************************************************************************************
* 根据端口号获取对应串口通道的类指针                                                          
*************************************************************************************/
CSerial * GetSerial(DWORD dwPort);


#endif
