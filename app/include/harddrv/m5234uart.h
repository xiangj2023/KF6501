#ifndef _M5234UART_H_
#define _M5234UART_H_

#include "resm5234.h"
#include "system.h"
#include "serial.h"

#if(MCF5234_UART == YES)

#define M5234_UART_CHAN0		0
#define M5234_UART_CHAN1		2

//UART的FIFO长度定义
#define UART_RXD_FIFO_LEN		4	//UART接收FIFO长度
#define UART_TXD_FIFO_LEN		2	//UART发送FIFO长度

/*************************************************************************************
* UART初始化，关闭收发功能                                                          
*************************************************************************************/
void M5234UartInit();

/*************************************************************************************
* 打开串口，加载中断，设置波特率、校验、方向控制信号等                                                          
*************************************************************************************/
DWORD M5234UartOpen(WORD wPort, TSerialMap *portInfo);

/*************************************************************************************
* 设置UART波特率，注意波特率的计算方法                                                         
*************************************************************************************/
DWORD M5234UartSetBaud(BYTE channel, BYTE BaudNum);

/*************************************************************************************
* 设置UART基本通信参数，如校验、数据位、起始位、停止位等                                                          
*************************************************************************************/
DWORD M5234UartSetComPar(BYTE channel, BYTE par);

/*************************************************************************************
* 根据串口通道类型初始化MODEM控制信号，对于UART只支持RTS和CTS信号                                                          
*************************************************************************************/
DWORD M5234UartModemInit(BYTE channel, BYTE medium);

/*************************************************************************************
* UART发送控制，当允许发送时，发送一个字节数据以触发发送中断                                                          
*************************************************************************************/
DWORD M5234UartTxd(WORD wPort, BYTE bFlag);

/*************************************************************************************
* UART接收控制                                                          
*************************************************************************************/
DWORD M5234UartRxd(WORD wPort, BYTE bFlag);

/*************************************************************************************
* UART中断处理函数                                                          
*************************************************************************************/
void M5234UartInt(void * arg);

/*************************************************************************************
* UART中断接收过程处理                                                          
*************************************************************************************/
void M5234UartRxdInt(CSerial* pSerial);

/*************************************************************************************
* UART中断发送过程处理                                                          
*************************************************************************************/
void M5234UartTxdInt(CSerial* pSerial);

/*************************************************************************************
* 通过UART发送一个字节数据，以触发发送中断                                                          
*************************************************************************************/
BOOL M5234UartWriteAChar(WORD wPort, BYTE bData);

/*************************************************************************************
* UART的IO控制接口函数，需要注意各个参数的含义和顺序                                                          
*************************************************************************************/
BOOL M5234UartIOCtl(WORD wPort, BYTE bCmd, DWORD *pdwPar1, DWORD *pdwPara2);

/*************************************************************************************
* MODEM信号输出控制，对于colefire的UART，只能控制RTS信号                                                          
*************************************************************************************/
BOOL M5234UartModemSet(BYTE channel, BYTE out, BYTE flag);

/*************************************************************************************
* 读取MODEM输入信号状态，对于colefire的UART，只能读取CTS信号                                                          
*************************************************************************************/
BOOL M5234UartModemGet(BYTE channel, BYTE *pFlag);

/*************************************************************************************
* UART波特率设置                                                          
*************************************************************************************/
BOOL M5234UartBaudSet(BYTE channel, DWORD baud);

/*************************************************************************************
* UART波特率值读取，实际上读取的是串口类的波特率序号所对应的波特率值                                                          
*************************************************************************************/
BOOL M5234UartBaudGet(CSerial* pSerial, DWORD *pBaud);

/*************************************************************************************
* UART通信参数设置，包括数据位、校验、停止位等内容                                                          
*************************************************************************************/
BOOL M5234UartParSet(BYTE channel, BYTE par);

/*************************************************************************************
* 根据UART相关寄存器的值，获得当前基本通信参数                                                          
*************************************************************************************/
BOOL M5235UartParGet(BYTE channel, BYTE *pPar);

/*************************************************************************************
* UART复位，复位发送、接收、错误状态，并重新打开发送、接收，仅允许接收中断                                                          
*************************************************************************************/
BOOL M5234UartReset(BYTE channel);

/*************************************************************************************
* 检查UART的连续一帧发送数据是否真正发送完成                                                          
*************************************************************************************/
BOOL M5234UartIsTxdEnd(BYTE channel);
	
#endif

#endif


