

#include "sysdefs.h"

LONG InverseCurCoefA[20][3] = {
	{-12350,28307,-16982},
	{-4554,5496,-916},
	{-2430,3260,-324},
	{-1065,2332,-165},
	{-50,1819,-100},
	{760,1492,-67},
	{1435,1266,-48},
	{2014,1100,-36},
	{2522,973,-28},
	{2974,872,-23},
	{3381,791,-19},
	{3752,723,-16},
	{4092,666,-13},
	{4407,618,-11},
	{4702,576,-10},
	{4971,540,-9},
	{5234,508,-8},
	{5470,479,-7},
	{5692,454,-6},
	{5923,431,-5}
};
//极反时限累加量系数表 
LONG InverseCurCoefB[] ={-100,100,0};
//甚反时限累加量系数表 
LONG InverseCurCoefC[] ={-1,0,1};
//角度计算查询表 
WORD AngleTab[]= {
9,18,27,36,45,54,63,72,81,90,99,108,117,126,135,144,153,162,171,180,189,198,207,
216,225,234,243,252,261,270,279,288,297,306,315,324,333,342,351,360,369,378,387,
396,405,414,423,432,441,450,459,468,477,486,495,504,513,522,531,540,550,559,568,
577,586,595,604,613,622,631,640,649,658,667,676,685,694,704,713,722,731,740,749,
758,767,776,785,794,803,813,822,831,840,849,858,867,876,885,894,904,913,922,931,
940,949,958,967,977,986,995,1004,1013,1022,1031,1041,1050,1059,1068,1077,1086,
1096,1105,1114,1123,1132,1141,1151,1160,1169,1178,1187,1197,1206,1215,1224,1233,
1243,1252,1261,1270,1280,1289,1298,1307,1317,1326,1335,1344,1354,1363,1372,1381,
1391,1400,1409,1418,1428,1437,1446,1456,1465,1474,1484,1493,1502,1512,1521,1530,
1540,1549,1558,1568,1577,1586,1596,1605,1614,1624,1633,1642,1652,1661,1671,1680,
1689,1699,1708,1718,1727,1737,1746,1755,1765,1774,1784,1793,1803,1812,1822,1831,
1841,1850,1860,1869,1879,1888,1898,1907,1917,1926,1936,1945,1955,1964,1974,1984,
1993,2003,2012,2022,2032,2041,2051,2060,2070,2080,2089,2099,2109,2118,2128,2137,
2147,2157,2167,2176,2186,2196,2205,2215,2225,2235,2244,2254,2264,2273,2283,2293,
2303,2313,2322,2332,2342,2352,2362,2371,2381,2391,2401,2411,2421,2431,2440,2450,
2460,2470,2480,2490,2500,2510,2520,2530,2540,2550,2560,2570,2580,2590,2600,2610,
2620,2630,2640,2650,2660,2670,2680,2690,2700,2710,2721,2731,2741,2751,2761,2771,
2781,2792,2802,2812,2822,2832,2843,2853,2863,2873,2884,2894,2904,2915,2925,2935,
2946,2956,2966,2977,2987,2997,3008,3018,3029,3039,3050,3060,3070,3081,3091,3102,
3112,3123,3133,3144,3155,3165,3176,3186,3197,3208,3218,3229,3239,3250,3261,3272,
3282,3293,3304,3314,3325,3336,3347,3358,3368,3379,3390,3401,3412,3423,3434,3444,
3455,3466,3477,3488,3499,3510,3521,3532,3543,3554,3565,3577,3588,3599,3610,3621,
3632,3643,3655,3666,3677,3688,3700,3711,3722,3733,3745,3756,3767,3779,3790,3802,
3813,3825,3836,3848,3859,3871,3882,3894,3905,3917,3929,3940,3952,3964,3975,3987,
3999,4010,4022,4034,4046,4058,4070,4081,4093,4105,4117,4129,4141,4153,4165,4177,
4189,4202,4214,4226,4238,4250,4262,4275,4287,4299,4312,4324,4336,4349,4361,4374,
4386,4398,4411,4424,4436,4449,4461,4474,4487,4500};
//0-85度余弦表，放大2000倍 
WORD CosAngleTab[] = {
2000,1999,1998,1997,1995,1992,1989,1985,1980,1975,1969,1963,1956,1948,1940,1931,
1922,1912,1902,1891,
1879,1867,1854,1841,1827,1812,1797,1782,1765,1749,1732,1714,1696,1677,1658,1638,
1618,1597,1576,1554,1532,1509,1486,1462,1438,1414,1389,1363,1338,1312,1285,1258,
1231,1203,1175,1147,1118,1089,1059,1030,1000,969,938,907,876,845,813,781,749,716
,684,651,618,584,551,517,483,449,415,381,347,312,278,243,209,174
};
/*
//45-85度余弦表，放大2000倍 

WORD CosAngleTab[] = {
1414,1389,1363,1338,1312,1285,1258,1231,1203,1175,1147,1118,1089,1059,1030,1000,
969,938,907,876,845,813,781,749,716,684,651,618,584,551,517,483,449,415,381,347,
312,278,243,209,174
};*/
//0-85度正弦表，放大2000倍 
WORD SinAngleTab[] ={
0,34,69,104,139,174,209,243,278,312,347,381,415,449,483,517,551,584,618,651,
684,716,749,781,813,845,876,907,938,969,999,1030,1059,1089,1118,1147,1175,1203,
1231,1258,1285,1312,1338,1363,1389,1414,1438,1462,1486,1509,1532,1554,1576,1597,
1618,1638,1658,1677,1696,1714,1732,1749,1765,1782,1797,1812,1827,1841,1854,1867,
1879,1891,1902,1912,1922,1931,1940,1948,1956,1963,1969,1975,1980,1985,1989,1992

};

/*
//45-85度正弦表，放大2000倍 
WORD SinAngleTab[] ={
1414,1438,1462,1486,1509,1532,1554,1576,1597,1618,1638,1658,1677,1696,1714,1732,
1749,1765,1782,1797,1812,1827,1841,1854,1867,1879,1891,1902,1912,1922,1931,1940,
1948,1956,1963,1969,1975,1980,1985,1989,1992
};*/
//10-85度正切表,放大100倍 
WORD TangAngleTab[] ={17,19,21,23,24,26,28,30,32,34,36,38,40,42,44,46,48,50,53,55,57,60,62,64,67,70,72
,75,78,80,83,86,90,93,96,100,104,107,111,115,119,123,127,132,137,142,148,153,160,166,173,180,188,196,205,214,
224,235,247,261,274,290,307,327,348,373,401,433,470,514,567,631,711,814,951,1143
};
// 2、3、5、7、9、11次谐波校正系数，放大1000倍
WORD VolHarmCal[] ={1007,1029,1097,1180,1290,1421};  //6570已用 
WORD CurHarmCal[] ={1013,1032,1086,1180,1278,1409};

WORD CurHarmCal_6570_I[] ={1019,1054,1155,1289,1447,1616};
WORD VolHarmCal_6570_U[] ={1012,1036,1107,1201,1315,1439};  //6570已用 

WORD CurHarmCal_6571_I[] ={1010,1030,1087}; //谐波校正系数
WORD VolHarmCal_6571_U[] ={1000,1000,1000};  //6570已用 

//变压器差动矩阵系数表，均放大了1000倍
LONG MatrixCoef[8][9]={
	{1000,0,0,0,1000,0,-1000,-1000,0},		// Y/D-11牵引变压器
	{1000,0,0,0,1000,0,0,0,1000},			// Y/D-11电力变压器
	{1366,-366,0,-366,1366,0,-1000,-1000,0},// Y/V平衡变压器
	{-2154,577,0,577,-2154,0,1577,1577,0},	// Y/A平衡变压器
	{-1732,1000,0,1732,1000,0,0,-2000,0},	// SCOTT变压器
	{1000,0,0,0,1000,0,-1000,-1000,0},	 	// 三相V/V变压器
	{1000,0,0,0,1000,0,0,0,0},				// 单相V/V变压器
	{1000,0,0,-1000,0,0,0,0,0}};			// 单相变压器
//三相VV变压器系数矩阵
LONG MartixVV3[3][9] = {
	{-1000,-1000,0,0,1000,0,1000,0,0}, //A相回流
	{1000,0,0,-1000,-1000,0,0,1000,0},	//B相回流
	{1000,0,0,0,1000,0,-1000,-1000,0}}; //C相回流
//单相VV变压器系数矩阵
LONG MartixVV1[3][9] = {
	{0,0,0,0,1000,0,1000,0,0},  //A相回流
	{1000,0,0,0,0,0,0,1000,0},//B相回流
	{1000,0,0,0,1000,0,0,0,0}};//C相回流
//三相VX变压器系数矩阵
LONG MartixAT2[3][6] = {
	{-1000,-1000,0,1000,1000,0}, //A相回流
	{1000,0,-1000,-1000,0,1000},	//B相回流
	{1000,0,0,1000,-1000,-1000}}; //C相回流
//6533变压器系数矩阵	
LONG Matrix6533[9]={-1000,0,0,0,-1000,0,0,0,-1000};
//crc校验余式表 
WORD CRCTab[] = {
		0x0000,0xC0C1,0xC181,0x0140,
		0xC301,0x03C0,0x0280,0xC241,
		0xC601,0x06C0,0x0780,0xC741,
		0x0500,0xC5C1,0xC481,0x0440,
		0x0000,0xCC01,0xD801,0x1400,
		0xF001,0x3C00,0x2800,0xE401,
		0xa001,0x6C00,0x7800,0xB401,
		0x5000,0x9C01,0x8801,0x4400
};

LONG WCT6535[3][3] ={{1000,577,333},	//根据6535高中低三侧绕组/CT连接方式确定的放大倍数
					{1732,1000,577},
					{3000,1732,1000}};

LONG Martix6535[13][9]={
						{1000,0,0,0,1000,0,0,0,1000},			  //前13行为差动及制动电流没有放大的电流角度校正 不校正
						{577,-577,0,0,577,-577,-577,0,577},		      	//逆时针30度
						{333,-667,333,333,333,-667,-667,333,333},      	//逆时针60度
						{0,-577,577,577,0,-577,-577,577,0},				//逆时针90度
						{-333,-333,667,667,-333,-333,-333,667,-333},	//逆时针120度
						{-577,0,577,577,-577,0,0,577,-577},				//逆时针150度
						{-667,333,333,333,-667,333,333,333,-667},		//逆时针180度
						{-577,577,0,0,-577,577,577,0,-577},				//逆时针210度
						{-333,667,-333,-333,-333,667,667,-333,-333},	//逆时针240度
						{0,577,-577,-577,0,577,577,-577,0},				//逆时针270度
						{333,333,-667,-667,333,333,333,-667,333},		//逆时针300度
						{577,0,-577,-577,577,0,0,-577,577},				//逆时针330度
						{667,-333,-333,-333,667,-333,-333,-333,667}};	//逆时针360度 去除零序电流  与不校正相位相同  
LONG Martix6535_AB[3][9]={					//中低压侧两相时差动及制动电流计算系数   
						{0,-1000,-1000,0,1000,0,0,0,1000},					//A相为公共相  前三行不放大
						{1000,0,0,-1000,0,-1000,0,0,1000},					//B相为公共相
						{1000,0,0,0,1000,0,-1000,-1000,0}};					//C相为公共相

